<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8"> 
	<meta name=viewport content="width=device-width, initial-scale=1">
	<title>thebutton thebutton thebutton thebutton thebutton thebutton thebutton thebutton thebutton</title>
	<link ref="text/css" rel="stylesheet" href="http://www.redditstatic.com/thebutton.i-G5y6pAHNE.css" />
	<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
	<script src="//cdnjs.cloudflare.com/ajax/libs/jqueryui/1.10.3/jquery-ui.min.js"></script>
    <style>
	    body,html{
	    	width:100%;
	    	height:100%;
	    	border:0;
	    	margin:0;
	    }
    	body{
    		text-align:center;
    		
    	}
    	.thebutton-form{
    		margin-top:200px;
    	}
    	#thebutton{
    		cursor:pointer;
    	}
    	.thebutton-container{
    		margin:0;
    	}
    	.image{
    		background-size:cover;
    		background-repeat:no-repeat;
    		position:absolute;
    		top:0;
    		left:0;
    		width:100%;
    		height:100%;
    		border:0;
    		z-index:0;
    	}
    </style>
</head>
<body>
	<div class="image"></div>
<form class="thebutton-form">
   <div class="thebutton-container locked active">
   	<button id="thebutton" title="BUTTON PRESS BUTTON PRESS IT BUTTON THE BUTTON PRESS IT PRESS THE BUTTON BUTTON BUTTON PRESS IT THE BUTTON THE BUTTON PRESS BUTTON IT PRESS IT THE BUTTON PRESS IT NOW" type="button">[you feel an overwhelming urge to press the button]</button>
   </div>
</form>
	<script>
		var subreddits = ["earthporn","CityPorn","ruralporn","botanicalporn","seaporn","skyporn","macroporn","remoteplaces","SummerPorn","earthporn"];

		$('.thebutton-container').on('touchstart mousedown',function(e){
			$(e.target).removeClass('locked');
			$(e.target).addClass('unlocking');
			setTimeout(function(){
				$(e.target).removeClass('unlocking');
				$(e.target).addClass('unlocked');
			},1000);
		});

		function playClick(){
			var click = $('#click')[0];
			click.currentTime = 0;
			click.play();
		}

		function playBoing(){
			var boing = $('#boing')[0];
			boing.currentTime = 0;
			boing.play();
		}

		function doRandomShit(){
			if(Math.random()>0.9){
				playBoing();
				getRandomContent();
			} else {
				playClick();
			}
		}

		function getRandomContent(){
			var sub = subreddits[Math.floor(Math.random()*10)];
			console.log(sub);
			var url = "http://www.reddit.com/r/"+sub+"/top/.json?sort=top&t=month";
			$.ajax({
			  url: url,
			  context: document.body
			}).done(function(content) {
			  processContent(content.data);
			});
		}

		function processContent(data){
			if(!data.children){
				return;
			}
			for(var i=0;i<data.children.length;i++){
				if(data.children[i].data && data.children[i].data.domain){
					if(data.children[i].data.domain.indexOf("imgur.com")===-1 || data.children[i].data.url.indexOf('/a/')!==-1){
						data.children.splice(i,1);
						i--;
					}
				}
			}
			if(data.children.length ==0){
				return;
			}
			var num = (Math.floor(data.children.length*Math.random()));
			console.log(num,data.children.length);
			var url = data.children[num].data.url;
			var sections = url.split('/');
			if(sections[sections.length-1].split('.').length<2){
				url+='.jpg';
			}
			$('.image').css('background-image',"url('"+url+"')");
		}

		$('#thebutton').on('touchstart mousedown',function(e){
			doRandomShit();
		});

	</script>

	<script>
	  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	  ga('create', 'UA-16169708-4', 'auto');
	  ga('send', 'pageview');

	</script>

	<audio id="click" src="media/click.wav"></audio>
	<audio id="boing" src="media/boing.wav"></audio>
	
</body>
</html>
